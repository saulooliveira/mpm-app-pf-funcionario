<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Escalas & Feriados ‚Ä¢ Folgas</title>
<link rel="stylesheet" href="./css/styles.css">
</head>
<body>
  <header>
    <div class="brand">
      <div class="logo">EF</div>
      <div>
        <div style="font-weight:700">Escalas & Feriados</div>
        <div style="font-size:.85rem;color:#9aa3b2">Folgas ‚Ä¢ Trocas ‚Ä¢ Calend√°rio</div>
      </div>
    </div>

    <div class="controls">
      <button class="btn" id="prevBtn">‚óÄ</button>
      <div id="currentLabel" class="kbd"></div>
      <button class="btn" id="nextBtn">‚ñ∂</button>

      <div class="btn-group" role="tablist" aria-label="Mudar visualiza√ß√£o">
        <button class="btn-tab active" data-view="month">Mensal</button>
        <button class="btn-tab" data-view="week">Semanal</button>
        <button class="btn-tab" data-view="day">Di√°ria</button>
      </div>

      <select id="employeeSelect" title="Selecionar funcion√°rio"></select>
      <button class="btn ghost" id="todayBtn">Hoje</button>

      <button class="btn adminOnly" id="syncAllBtn">üì° Sincronizar feriados</button>
      <button class="btn adminOnly" id="openSettings">‚öôÔ∏è Configurar APIs</button>
      <button class="btn adminOnly" id="manageUsersBtn">üë§ Usu√°rios</button>

      <span class="kbd" id="sessionBadge">‚Äî</span>
      <button class="btn" id="logoutBtn">Sair</button>
    </div>
  </header>

  <main>
    <section class="calendar" aria-label="Calend√°rio">
      <div class="cal-header split">
        <div class="split">
          <span class="label">Data selecionada:</span>
          <span id="selectedDateLabel" class="pill">‚Äî</span>
        </div>
        <div class="split">
          <button class="btn adminOnly" id="toggleHolidayBtn">‚õ±Ô∏è Marcar/Desmarcar Feriado</button>
          <button class="btn adminOnly" id="editScaleBtn">üë• Editar escala</button>
          <button class="btn primary" id="swapBtn">üîÑ Solicitar troca</button>
        </div>
      </div>
      <div id="calendarBody"></div>
    </section>

    <div class="side">
      <section class="panel">
        <h3>Vis√£o Equipe</h3>
        <div class="split" style="margin-bottom:.6rem">
          <div class="split">
            <div class="label">Data base</div>
            <input type="date" id="teamDate">
          </div>
          <div class="btn-group" style="margin-left:.4rem">
            <button class="btn-tab active" data-team="day">Dia</button>
            <button class="btn-tab" data-team="week">Semana</button>
          </div>
          <div class="right muted" id="teamMeta"></div>
        </div>
        <div style="overflow:auto;max-height:420px;border:1px solid #242a48;border-radius:12px">
          <table id="teamTable">
            <thead></thead>
            <tbody></tbody>
          </table>
        </div>
      </section>

      <section class="panel" id="myRequestsPanel">
        <h3>Minhas solicita√ß√µes de troca</h3>
        <div id="requestsList" class="list"></div>
      </section>

      <section class="panel adminOnly">
        <h3>Painel do Admin ‚Äî Aprovar trocas</h3>
        <div id="adminRequestsList" class="list"></div>
      </section>

      <section class="panel">
        <h3>Feriados</h3>
        <div class="grid3 adminOnly">
          <input type="date" id="holidayDate">
          <button class="btn" id="addHolidayBtn">‚ûï Adicionar</button>
          <button class="btn" id="resyncYearBtn">üîÅ Re-sync ano vis√≠vel</button>
        </div>
        <div id="holidayList" class="list" style="margin-top:.8rem"></div>
      </section>
    </div>
  </main>

  <!-- Modal -->
  <div id="modal" style="display:none;position:fixed;inset:0;background:rgba(0,0,0,.5);align-items:center;justify-content:center;z-index:50;">
    <div class="panel" style="width:min(680px,92vw);max-height:86vh;overflow:auto">
      <div class="split">
        <h3 id="modalTitle">Modal</h3>
        <button class="btn" id="closeModal">‚úñ</button>
      </div>
      <div id="modalContent"></div>
    </div>
  </div>

  <!-- Settings bottom sheet -->
  <div class="settings" id="settingsSheet">
    <div class="sheet">
      <div class="split" style="justify-content:space-between">
        <h3>Configura√ß√µes de Feriados (UF/Munic√≠pio & APIs)</h3>
        <button class="btn" id="closeSettings">Fechar</button>
      </div>
      <div class="grid3">
        <div>
          <div class="label">UF (estado)</div>
          <select id="ufSelect">
            <option value="SP" selected>SP ‚Äî S√£o Paulo</option>
            <option value="RJ">RJ ‚Äî Rio de Janeiro</option>
            <option value="MG">MG ‚Äî Minas Gerais</option>
            <option value="RS">RS ‚Äî Rio Grande do Sul</option>
            <option value="PR">PR ‚Äî Paran√°</option>
          </select>
        </div>
        <div>
          <div class="label">Munic√≠pio (IBGE)</div>
          <input id="ibgeCity" type="text" value="3550308" placeholder="ex.: 3550308 (S√£o Paulo)"/>
        </div>
        <div>
          <div class="label">Ano alvo</div>
          <input id="settingsYear" type="number" min="2000" max="2100" />
        </div>
      </div>

      <div class="grid2" style="margin-top:.8rem">
        <div>
          <div class="label">Calendarific API Key (estado/UF)</div>
          <input id="calendarificKey" type="text" placeholder="opcional ‚Äî region=UF"/>
        </div>
        <div>
          <div class="label">Invertexto Token (municipal)</div>
          <input id="invertextoToken" type="text" placeholder="opcional ‚Äî city=IBGE"/>
        </div>
      </div>

      <div class="split" style="justify-content:flex-end;margin-top:1rem">
        <button class="btn" id="saveSettings">Salvar</button>
        <button class="btn primary" id="testSync">Testar sync agora</button>
      </div>
    </div>
  </div>

  <!-- Login -->
  <div id="loginOverlay">
    <div class="loginCard">
      <h3 style="margin-top:0">Entrar</h3>
      <div class="grid2">
        <div>
          <div class="label">Perfil</div>
          <select id="loginRole">
            <option value="admin">Admin</option>
            <option value="func" selected>Funcion√°rio</option>
          </select>
        </div>
        <div id="loginEmployeeWrap">
          <div class="label">Funcion√°rio</div>
          <select id="loginEmployee"></select>
        </div>
      </div>
      <div class="split" style="justify-content:flex-end;margin-top:1rem">
        <button class="btn primary" id="loginBtn">Entrar</button>
      </div>
      <div class="muted" style="font-size:.9rem;margin-top:.4rem">
        Funcion√°rio v√™ a escala e solicita trocas. Admin gerencia tudo.
      </div>
    </div>
  </div>

  <script type="module" src="./js/main.js"></script>
</body>
</html>
